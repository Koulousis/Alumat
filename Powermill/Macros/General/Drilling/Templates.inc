//Mandrel and Allargatore
//Pozzeto side
//Toolpath Creation for Spine
FUNCTION SPINE_POZZETO_D10_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		//SGR Procedure                Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $CENTRINO    = "SPINE POZZETO D10 CENTRINO    2         T202      3"
		STRING $DRILL       = "SPINE POZZETO D10 DRILL       2         T226      13"
		STRING $SMUSSO      = "SPINE POZZETO D10 SMUSSO      1         T369      3"
		$TOOLPATHS = {$CENTRINO , $DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Spine\D10\SPINE POZZETO D10 SGR.ptf"
	} ELSE {
		
		//FINtf Procedure              Toolpath            Index  Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $CENTRINO    = "SPINE POZZETO D10 CENTRINO    2         T202      3"
		STRING $DRILL       = "SPINE POZZETO D10 DRILL       2         T225      15"
		STRING $PREFIN      = "SPINE POZZETO D10 PREFIN      2         T964      10"
		STRING $SMUSSO      = "SPINE POZZETO D10 SMUSSO      1         T806      3"
		STRING $SEMIFIN     = "SPINE POZZETO D10 SEMIFIN     2         T971      9"
		STRING $FIN         = "SPINE POZZETO D10 FIN         2         T971      9"
		$TOOLPATHS = {$CENTRINO , $DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Spine\D10\SPINE POZZETO D10 FINTF.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D10_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D10_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D10_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D10_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINE_POZZETO_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		//SGR Procedure                Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE POZZETO D12 DRILL       2         T232      16"
		STRING $SMUSSO      = "SPINE POZZETO D12 SMUSSO      1         T369      3"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Spine\D12\SPINE POZZETO D12 SGR.ptf"
	} ELSE {
		
		//FINtf Procedure              Toolpath            Index  Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE POZZETO D12 DRILL       2         T228      20"
		STRING $PREFIN      = "SPINE POZZETO D12 PREFIN      2         T965      15"
		STRING $SMUSSO      = "SPINE POZZETO D12 SMUSSO      1         T806      3"
		STRING $SEMIFIN     = "SPINE POZZETO D12 SEMIFIN     2         T972      14"
		STRING $FIN         = "SPINE POZZETO D12 FIN         2         T972      14"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Spine\D12\SPINE POZZETO D12 FINTF.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINE_POZZETO_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		//SGR Procedure                Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE POZZETO D16 DRILL       2         T240      22"
		STRING $SMUSSO      = "SPINE POZZETO D16 SMUSSO      1         T369      3"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Spine\D16\SPINE POZZETO D16 SGR.ptf"
	} ELSE {
		
		//FINtf Procedure              Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE POZZETO D16 DRILL       2         T238      25"
		STRING $PREFIN      = "SPINE POZZETO D16 PREFIN      2         T966      17"
		STRING $SMUSSO      = "SPINE POZZETO D16 SMUSSO      1         T806      3"
		STRING $SEMIFIN     = "SPINE POZZETO D16 SEMIFIN     2         T983      15"
		STRING $FIN         = "SPINE POZZETO D16 FIN         2         T983      15"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Spine\D16\SPINE POZZETO D16 FINTF.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D16_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D16_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D16_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D16_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Toolpath Creation for Spinone
FUNCTION SPINONE_POZZETO_D6_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = 13
	
	STRING $AUTOORNOT = "Spinone D6 defined depth is " + $DEPTH + CRLF + "Do you want to change the depth?"
	BOOL $AUTOAGREE = FALSE
	$AUTOAGREE = QUERY $AUTOORNOT
	IF $AUTOAGREE {
		$DEPTH = INPUT "Spinone D6 Depth:"
		WHILE $DEPTH < 0 {
			MESSAGE INFO "The value must be positive"
			$DEPTH = INPUT "Spinone D6 Depth:"
		}
	}
	
	REAL $DRILLDEPTH = $DEPTH
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index  Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $CENTRINO    = "SPINONE POZZETO D6 CENTRINO   2         T202      3"
	STRING $DRILL       = "SPINONE POZZETO D6 DRILL      2         T219      " + $DRILLDEPTH
	STRING $SMUSSO      = "SPINONE POZZETO D6 SMUSSO     2         T369      3"
	$TOOLPATHS = {$CENTRINO , $DRILL , $SMUSSO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Spinone\D6\SPINONE POZZETO D6 FINTF.ptf"
	
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D6_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D6_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D6_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D6_4"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D6_5"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D6_6"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D6_7"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D6_8"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_POZZETO_D8_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = 15
	
	STRING $AUTOORNOT = "Spinone D8 defined depth is " + $DEPTH + CRLF + "Do you want to change the depth?"
	BOOL $AUTOAGREE = FALSE
	$AUTOAGREE = QUERY $AUTOORNOT
	IF $AUTOAGREE {
		$DEPTH = INPUT "Spinone D8 Depth:"
		WHILE $DEPTH < 0 {
			MESSAGE INFO "The value must be positive"
			$DEPTH = INPUT "Spinone D8 Depth:"
		}
	}
	
	REAL $DRILLDEPTH = $DEPTH
	REAL $PREFINDEPTH = $DEPTH - 5
	REAL $SEMIFINDEPTH = $DEPTH - 6
	REAL $FINDEPTH = $DEPTH - 6
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index  Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $CENTRINO    = "SPINONE POZZETO D8 CENTRINO   2         T202      3"
	STRING $DRILL       = "SPINONE POZZETO D8 DRILL      2         T219      " + $DRILLDEPTH
	STRING $PREFIN      = "SPINONE POZZETO D8 PREFIN     2         T977      " + $PREFINDEPTH
	STRING $SMUSSO      = "SPINONE POZZETO D8 SMUSSO     1         T806      3"
	STRING $SEMIFIN     = "SPINONE POZZETO D8 SEMIFIN    2         T957      " + $SEMIFINDEPTH 
	STRING $FIN         = "SPINONE POZZETO D8 FIN        2         T957      " + $FINDEPTH
	$TOOLPATHS = {$CENTRINO , $DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Spinone\D8\SPINONE POZZETO D8 FINTF.ptf"
	
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D8_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D8_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D8_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D8_4"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D8_5"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D8_6"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D8_7"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D8_8"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_POZZETO_D10_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = 15
	
	STRING $AUTOORNOT = "Spinone D10 defined depth is " + $DEPTH + CRLF + "Do you want to change the depth?"
	BOOL $AUTOAGREE = FALSE
	$AUTOAGREE = QUERY $AUTOORNOT
	IF $AUTOAGREE {
		$DEPTH = INPUT "Spinone D10 Depth:"
		WHILE $DEPTH < 0 {
			MESSAGE INFO "The value must be positive"
			$DEPTH = INPUT "Spinone D10 Depth:"
		}
	}
	
	REAL $DRILLDEPTH = $DEPTH
	REAL $PREFINDEPTH = $DEPTH - 5
	REAL $SEMIFINDEPTH = $DEPTH - 6
	REAL $FINDEPTH = $DEPTH - 6
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index  Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $CENTRINO    = "SPINONE POZZETO D10 CENTRINO  2         T202      3"
	STRING $DRILL       = "SPINONE POZZETO D10 DRILL     2         T225      " + $DRILLDEPTH
	STRING $PREFIN      = "SPINONE POZZETO D10 PREFIN    2         T964      " + $PREFINDEPTH
	STRING $SMUSSO      = "SPINONE POZZETO D10 SMUSSO    1         T806      3"
	STRING $SEMIFIN     = "SPINONE POZZETO D10 SEMIFIN   2         T971      " + $SEMIFINDEPTH
	STRING $FIN         = "SPINONE POZZETO D10 FIN       2         T971      " + $FINDEPTH
	$TOOLPATHS = {$CENTRINO , $DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Spinone\D10\SPINONE POZZETO D10 FINTF.ptf"
	
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D10_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D10_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D10_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D10_4"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D10_5"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D10_6"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D10_7"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D10_8"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_POZZETO_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = 20
	
	STRING $AUTOORNOT = "Spinone D12 defined depth is " + $DEPTH + CRLF + "Do you want to change the depth?"
	BOOL $AUTOAGREE = FALSE
	$AUTOAGREE = QUERY $AUTOORNOT
	IF $AUTOAGREE {
		$DEPTH = INPUT "Spinone D12 Depth:"
		WHILE $DEPTH < 0 {
			MESSAGE INFO "The value must be positive"
			$DEPTH = INPUT "Spinone D12 Depth:"
		}
	}
	
	REAL $DRILLDEPTH = $DEPTH
	REAL $PREFINDEPTH = $DEPTH - 5
	REAL $SEMIFINDEPTH = $DEPTH - 6
	REAL $FINDEPTH = $DEPTH - 6
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index  Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE POZZETO D12 DRILL     2         T228      " + $DRILLDEPTH
	STRING $PREFIN      = "SPINONE POZZETO D12 PREFIN    2         T965      " + $PREFINDEPTH
	STRING $SMUSSO      = "SPINONE POZZETO D12 SMUSSO    1         T806      3"
	STRING $SEMIFIN     = "SPINONE POZZETO D12 SEMIFIN   2         T972      " + $SEMIFINDEPTH
	STRING $FIN         = "SPINONE POZZETO D12 FIN       2         T972      " + $FINDEPTH
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Spinone\D12\SPINONE POZZETO D12 FINTF.ptf"
	
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D12_4"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D12_5"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D12_6"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D12_7"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D12_8"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_POZZETO_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = 25
	
	STRING $AUTOORNOT = "Spinone D16 defined depth is " + $DEPTH + CRLF + "Do you want to change the depth?"
	BOOL $AUTOAGREE = FALSE
	$AUTOAGREE = QUERY $AUTOORNOT
	IF $AUTOAGREE {
		$DEPTH = INPUT "Spinone D16 Depth:"
		WHILE $DEPTH < 0 {
			MESSAGE INFO "The value must be positive"
			$DEPTH = INPUT "Spinone D16 Depth:"
		}
	}
	
	REAL $DRILLDEPTH = $DEPTH
	REAL $PREFINDEPTH = $DEPTH - 5
	REAL $SEMIFINDEPTH = $DEPTH - 6
	REAL $FINDEPTH = $DEPTH - 6
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE POZZETO D16 DRILL     2         T238      " + $DRILLDEPTH
	STRING $PREFIN      = "SPINONE POZZETO D16 PREFIN    2         T966      " + $PREFINDEPTH
	STRING $SMUSSO      = "SPINONE POZZETO D16 SMUSSO    1         T806      3"
	STRING $SEMIFIN     = "SPINONE POZZETO D16 SEMIFIN   2         T983      " + $SEMIFINDEPTH
	STRING $FIN         = "SPINONE POZZETO D16 FIN       2         T983      " + $FINDEPTH
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
		
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Spinone\D16\SPINONE POZZETO D16 FINTF.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D16_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D16_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D16_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D16_4"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D16_5"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D16_6"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D16_7"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D16_8"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_POZZETO_D20_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = 30
	
	STRING $AUTOORNOT = "Spinone D20 defined depth is " + $DEPTH + CRLF + "Do you want to change the depth?"
	BOOL $AUTOAGREE = FALSE
	$AUTOAGREE = QUERY $AUTOORNOT
	IF $AUTOAGREE {
		$DEPTH = INPUT "Spinone D20 Depth:"
		WHILE $DEPTH < 0 {
			MESSAGE INFO "The value must be positive"
			$DEPTH = INPUT "Spinone D20 Depth:"
		}
	}
	
	REAL $DRILLDEPTH = $DEPTH
	REAL $PREFINDEPTH = $DEPTH - 5
	REAL $SEMIFINDEPTH = $DEPTH - 6
	REAL $FINDEPTH = $DEPTH - 6
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE POZZETO D20 DRILL     2         T260      " + $DRILLDEPTH
	STRING $PREFIN      = "SPINONE POZZETO D20 PREFIN    2         T967      " + $PREFINDEPTH
	STRING $SMUSSO      = "SPINONE POZZETO D20 SMUSSO    1         T806      3"
	STRING $SEMIFIN     = "SPINONE POZZETO D20 SEMIFIN   2         T983      " + $SEMIFINDEPTH
	STRING $FIN         = "SPINONE POZZETO D20 FIN       2         T983      " + $FINDEPTH
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
		
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Spinone\D20\SPINONE POZZETO D20 FINTF.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D20_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D20_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D20_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D20_4"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D20_5"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D20_6"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D20_7"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D20_8"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_POZZETO_D24_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = 28
	
	STRING $AUTOORNOT = "Spinone D24 defined depth is " + $DEPTH + CRLF + "Do you want to change the depth?"
	BOOL $AUTOAGREE = FALSE
	$AUTOAGREE = QUERY $AUTOORNOT
	IF $AUTOAGREE {
		$DEPTH = INPUT "Spinone D24 Depth:"
		WHILE $DEPTH < 0 {
			MESSAGE INFO "The value must be positive"
			$DEPTH = INPUT "Spinone D24 Depth:"
		}
	}
	
	REAL $HELICALDEPTH = $DEPTH
	REAL $PREFINDEPTH = $DEPTH - 2
	REAL $SEMIFINDEPTH = $DEPTH - 4
	REAL $FINDEPTH = $DEPTH - 4
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE POZZETO D24 HELICAL   2         T421      " + $HELICALDEPTH
	STRING $PREFIN      = "SPINONE POZZETO D24 PREFIN    2         T967      " + $PREFINDEPTH
	STRING $SMUSSO      = "SPINONE POZZETO D24 SMUSSO    1         T806      3"
	STRING $SEMIFIN     = "SPINONE POZZETO D24 SEMIFIN   2         T974      " + $SEMIFINDEPTH
	STRING $FIN         = "SPINONE POZZETO D24 FIN       2         T974      " + $FINDEPTH
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
		
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Spinone\D24\SPINONE POZZETO D24 FINTF.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D24_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D24_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D24_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D24_4"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D24_5"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D24_6"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D24_7"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D24_8"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_POZZETO_D30_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = 25
	
	STRING $AUTOORNOT = "Spinone D30 defined depth is " + $DEPTH + CRLF + "Do you want to change the depth?"
	BOOL $AUTOAGREE = FALSE
	$AUTOAGREE = QUERY $AUTOORNOT
	IF $AUTOAGREE {
		$DEPTH = INPUT "Spinone D30 Depth:"
		WHILE $DEPTH < 0 {
			MESSAGE INFO "The value must be positive"
			$DEPTH = INPUT "Spinone D30 Depth:"
		}
	}
	
	REAL $HELICALDEPTH = $DEPTH
	REAL $PREFINDEPTH = $DEPTH - 2
	REAL $SEMIFINDEPTH = $DEPTH - 4
	REAL $FINDEPTH = $DEPTH - 4
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE POZZETO D30 HELICAL   2         T421      " + $HELICALDEPTH
	STRING $PREFIN      = "SPINONE POZZETO D30 PREFIN    2         T967      " + $PREFINDEPTH
	STRING $SMUSSO      = "SPINONE POZZETO D30 SMUSSO    1         T806      3"
	STRING $SEMIFIN     = "SPINONE POZZETO D30 SEMIFIN   2         T974      " + $SEMIFINDEPTH
	STRING $FIN         = "SPINONE POZZETO D30 FIN       2         T974      " + $FINDEPTH
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
		
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Spinone\D30\SPINONE POZZETO D30 FINTF.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D30_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D30_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D30_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D30_4"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D30_5"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D30_6"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D30_7"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_POZZETO_D30_8"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}


//Toolpath Creation for Viti
FUNCTION VITI_POZZETO_D10_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $CENTRINO    = "VITI POZZETO M10 CENTRINO     2         T202      3"
	STRING $DRILL       = "VITI POZZETO M10 DRILL        2         T225      25"
	STRING $SMUSSO      = "VITI POZZETO M10 SMUSSO       1         T369      3"
	STRING $MASCHIO     = "VITI POZZETO M10 MASCHIO      2         T701      20"
	$TOOLPATHS = {$CENTRINO , $DRILL , $SMUSSO , $MASCHIO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Viti\M10\VITI POZZETO M10.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M10_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M10_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M10_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M10_4"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M10_5"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M10_6"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M10_7"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M10_8"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION VITI_POZZETO_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "VITI POZZETO M12 DRILL        2         T228      30"
	STRING $SMUSSO      = "VITI POZZETO M12 SMUSSO       1         T369      3"
	STRING $MASCHIO     = "VITI POZZETO M12 MASCHIO      2         T702      24"
	$TOOLPATHS = {$DRILL , $SMUSSO , $MASCHIO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Viti\M12\VITI POZZETO M12.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M12_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M12_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M12_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M12_4"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M12_5"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M12_6"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M12_7"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M12_8"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION VITI_POZZETO_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "VITI POZZETO M16 DRILL        2         T238      40"
	STRING $SMUSSO      = "VITI POZZETO M16 SMUSSO       1         T369      3"
	STRING $MASCHIO     = "VITI POZZETO M16 MASCHIO      2         T704      32"
	$TOOLPATHS = {$DRILL , $SMUSSO , $MASCHIO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Pozzeto\Viti\M16\VITI POZZETO M16.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M16_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M16_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M16_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M16_4"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M16_5"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M16_6"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M16_7"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M16_8"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Matrice and Piana
//Camera side
//Toolpath Creation for Spine
FUNCTION SPINE_CAMERA_D10_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $ALLARGATORE_FIRST , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = $MATRICEHEIGHT
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $PIANA AND $MANUAL_ALLIGN {
		//SCA Procedure                Toolpath            Index       Tool     Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $CENTRINO    = "SPINE CAMERA D10 CENTRINO     2         T202      3"
		STRING $DRILL       = "SPINE CAMERA D10 DRILL        2         T232      20"
		STRING $SMUSSO      = "SPINE CAMERA D10 SMUSSO       1         T369      3 "
		$TOOLPATHS = {$CENTRINO , $DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Spine\D10\SPINE CAMERA D10 SCA.ptf"
	} ELSE {
		
		//FINsf Procedure              Toolpath            Index       Tool     Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $CENTRINO    = "SPINE CAMERA D10 CENTRINO     2         T202      3"
		STRING $DRILL       = "SPINE CAMERA D10 DRILL        2         T225      20"
		STRING $PREFIN      = "SPINE CAMERA D10 PREFIN       2         T964      10"
		STRING $SMUSSO      = "SPINE CAMERA D10 SMUSSO       1         T806      3 "
		STRING $SEMIFIN     = "SPINE CAMERA D10 SEMIFIN      2         T971      9"
		STRING $FIN         = "SPINE CAMERA D10 FIN          2         T971      9"
		$TOOLPATHS = {$CENTRINO , $DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Spine\D10\SPINE CAMERA D10 FINSF.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D10_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D10_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D10_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D10_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINE_CAMERA_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $ALLARGATORE_FIRST , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = $MATRICEHEIGHT
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $PIANA AND $MANUAL_ALLIGN {
		//SCA Procedure                Toolpath            Index       Tool     Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE CAMERA D12 DRILL        2         T238      20"
		STRING $SMUSSO      = "SPINE CAMERA D12 SMUSSO       1         T369      3 "
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Spine\D12\SPINE CAMERA D12 SCA.ptf"
	} ELSE {
		
		//FINsf Procedure              Toolpath            Index       Tool     Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE CAMERA D12 DRILL        2         T228      25"
		STRING $PREFIN      = "SPINE CAMERA D12 PREFIN       2         T965      17"
		STRING $SMUSSO      = "SPINE CAMERA D12 SMUSSO       1         T806      3 "
		STRING $SEMIFIN     = "SPINE CAMERA D12 SEMIFIN      2         T972      17"
		STRING $FIN         = "SPINE CAMERA D12 FIN          2         T803      17"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Spine\D12\SPINE CAMERA D12 FINSF.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINE_CAMERA_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $ALLARGATORE_FIRST , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = $MATRICEHEIGHT
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $PIANA AND $MANUAL_ALLIGN {
		//SCA Procedure                Toolpath            Index       Tool     Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE CAMERA D16 DRILL        2         T260      20"
		STRING $SMUSSO      = "SPINE CAMERA D16 SMUSSO       1         T369      3 "
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Spine\D16\SPINE CAMERA D16 SCA.ptf"
	} ELSE {
		
		//FINsf Procedure              Toolpath            Index       Tool     Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE CAMERA D16 DRILL        2         T238      25"
		STRING $PREFIN      = "SPINE CAMERA D16 PREFIN       2         T966      17"
		STRING $SMUSSO      = "SPINE CAMERA D16 SMUSSO       1         T806      3 "
		STRING $SEMIFIN     = "SPINE CAMERA D16 SEMIFIN      2         T973      17"
		STRING $FIN         = "SPINE CAMERA D16 FIN          2         T973      17"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Spine\D16\SPINE CAMERA D16 FINSF.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D16_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D16_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D16_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D16_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Toolpath Creation for Spinone
FUNCTION SPINONE_CAMERA_D6_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index  Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $CENTRINO    = "SPINONE CAMERA D6 CENTRINO    2         T202      3"
	STRING $PREDRILL    = "SPINONE CAMERA D6 PREDRILL    2         T215      18"
	STRING $DRILL       = "SPINONE CAMERA D6 DRILL       2         T219      18"
	STRING $SMUSSO      = "SPINONE CAMERA D6 SMUSSO      2         T369      3.4"
	$TOOLPATHS = {$CENTRINO , $PREDRILL , $DRILL , $SMUSSO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Spinone\D6\SPINONE CAMERA D6 FINSF.ptf"
	
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D6_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D6_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D6_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D6_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_CAMERA_D8_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index  Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $CENTRINO    = "SPINONE CAMERA D8 CENTRINO    2         T202      3"
	STRING $DRILL       = "SPINONE CAMERA D8 DRILL       2         T219      15"
	STRING $PREFIN      = "SPINONE CAMERA D8 PREFIN      2         T977      10"
	STRING $SMUSSO      = "SPINONE CAMERA D8 SMUSSO      1         T806      3"
	STRING $SEMIFIN     = "SPINONE CAMERA D8 SEMIFIN     2         T957      9"
	STRING $FIN         = "SPINONE CAMERA D8 FIN         2         T957      9"
	$TOOLPATHS = {$CENTRINO , $DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Spinone\D8\SPINONE CAMERA D8 FINSF.ptf"
	
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D8_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D8_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D8_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D8_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_CAMERA_D10_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index  Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $CENTRINO    = "SPINONE CAMERA D10 CENTRINO   2         T202      3"
	STRING $DRILL       = "SPINONE CAMERA D10 DRILL      2         T225      15"
	STRING $PREFIN      = "SPINONE CAMERA D10 PREFIN     2         T964      10"
	STRING $SMUSSO      = "SPINONE CAMERA D10 SMUSSO     1         T806      3"
	STRING $SEMIFIN     = "SPINONE CAMERA D10 SEMIFIN    2         T971      9"
	STRING $FIN         = "SPINONE CAMERA D10 FIN        2         T971      9"
	$TOOLPATHS = {$CENTRINO , $DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Spinone\D10\SPINONE CAMERA D10 FINSF.ptf"
	
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D10_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D10_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D10_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D10_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_CAMERA_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index  Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE CAMERA D12 DRILL      2         T228      20"
	STRING $PREFIN      = "SPINONE CAMERA D12 PREFIN     2         T965      17"
	STRING $SMUSSO      = "SPINONE CAMERA D12 SMUSSO     1         T806      3"
	STRING $SEMIFIN     = "SPINONE CAMERA D12 SEMIFIN    2         T972      17"
	STRING $FIN         = "SPINONE CAMERA D12 FIN        2         T972      17"
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Spinone\D12\SPINONE CAMERA D12 FINSF.ptf"
	
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_CAMERA_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE CAMERA D16 DRILL      2         T238      25"
	STRING $PREFIN      = "SPINONE CAMERA D16 PREFIN     2         T966      17"
	STRING $SMUSSO      = "SPINONE CAMERA D16 SMUSSO     1         T806      3"
	STRING $SEMIFIN     = "SPINONE CAMERA D16 SEMIFIN    2         T983      17"
	STRING $FIN         = "SPINONE CAMERA D16 FIN        2         T983      17"
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
		
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Spinone\D16\SPINONE CAMERA D16 FINSF.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D16_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D16_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D16_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D16_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_CAMERA_D20_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE CAMERA D20 DRILL      2         T260      30"
	STRING $PREFIN      = "SPINONE CAMERA D20 PREFIN     2         T967      23"
	STRING $SMUSSO      = "SPINONE CAMERA D20 SMUSSO     1         T806      3"
	STRING $SEMIFIN     = "SPINONE CAMERA D20 SEMIFIN    2         T983      17"
	STRING $FIN         = "SPINONE CAMERA D20 FIN        2         T983      17"
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
		
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Spinone\D20\SPINONE CAMERA D20 FINSF.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D20_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D20_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D20_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D20_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_CAMERA_D24_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = 25
	
	STRING $AUTOORNOT = "Spinone D24 defined depth is " + $DEPTH + CRLF + "Do you want to change the depth?"
	BOOL $AUTOAGREE = FALSE
	$AUTOAGREE = QUERY $AUTOORNOT
	IF $AUTOAGREE {
		$DEPTH = INPUT "Spinone D24 Depth:"
		WHILE $DEPTH < 0 {
			MESSAGE INFO "The value must be positive"
			$DEPTH = INPUT "Spinone D24 Depth:"
		}
	}
	
	REAL $HELICALDEPTH = $DEPTH
	REAL $PREFINDEPTH = $DEPTH - 2
	REAL $SEMIFINDEPTH = $DEPTH - 4
	REAL $FINDEPTH = $DEPTH - 4
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE CAMERA D24 HELICAL    2         T421      " + $HELICALDEPTH
	STRING $PREFIN      = "SPINONE CAMERA D24 PREFIN     2         T967      " + $PREFINDEPTH
	STRING $SMUSSO      = "SPINONE CAMERA D24 SMUSSO     1         T806      3"
	STRING $SEMIFIN     = "SPINONE CAMERA D24 SEMIFIN    2         T974      " + $SEMIFINDEPTH
	STRING $FIN         = "SPINONE CAMERA D24 FIN        2         T974      " + $FINDEPTH
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
		
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Spinone\D24\SPINONE CAMERA D24 FINSF.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D24_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D24_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D24_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D24_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_CAMERA_D30_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = 30
	
	STRING $AUTOORNOT = "Spinone D30 defined depth is " + $DEPTH + CRLF + "Do you want to change the depth?"
	BOOL $AUTOAGREE = FALSE
	$AUTOAGREE = QUERY $AUTOORNOT
	IF $AUTOAGREE {
		$DEPTH = INPUT "Spinone D30 Depth:"
		WHILE $DEPTH < 0 {
			MESSAGE INFO "The value must be positive"
			$DEPTH = INPUT "Spinone D30 Depth:"
		}
	}
	
	REAL $HELICALDEPTH = $DEPTH
	REAL $PREFINDEPTH = $DEPTH - 2
	REAL $SEMIFINDEPTH = $DEPTH - 4
	REAL $FINDEPTH = $DEPTH - 4
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE CAMERA D30 HELICAL    2         T421      " + $HELICALDEPTH
	STRING $PREFIN      = "SPINONE CAMERA D30 PREFIN     2         T967      " + $PREFINDEPTH
	STRING $SMUSSO      = "SPINONE CAMERA D30 SMUSSO     1         T806      3"
	STRING $SEMIFIN     = "SPINONE CAMERA D30 SEMIFIN    2         T967      " + $SEMIFINDEPTH
	STRING $FIN         = "SPINONE CAMERA D30 FIN        2         T967      " + $FINDEPTH
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
		
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Spinone\D30\SPINONE CAMERA D30 FINSF.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D30_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D30_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D30_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_CAMERA_D30_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}


//Toolpath Creation for Viti
FUNCTION VITI_CAMERA_D10_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT / 2 + 7
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//Non counterbore              Toolpath            Index       Tool    Depth
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $CENTRINO    = "VITI CAMERA M10 CENTRINO      2         T202      3"
	STRING $DRILL       = "VITI CAMERA M10 DRILL         2         T232      " + $DEPTH
	STRING $SMUSSO      = "VITI CAMERA M10 SMUSSO        1         T369      3"
	$TOOLPATHS = {$CENTRINO , $DRILL , $SMUSSO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Viti\M10\VITI CAMERA M10.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M10_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M10_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M10_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M10_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION VITI_CAMERA_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT / 2 + 7
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//Non counterbore              Toolpath            Index       Tool    Depth
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "VITI CAMERA M12 DRILL         2         T238      " + $DEPTH
	STRING $SMUSSO      = "VITI CAMERA M12 SMUSSO        1         T369      3"
	$TOOLPATHS = {$DRILL , $SMUSSO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Viti\M12\VITI CAMERA M12.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M12_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M12_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M12_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION VITI_CAMERA_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT / 2 + 7
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//Non counterbore              Toolpath            Index       Tool    Depth
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "VITI CAMERA M16 DRILL         2         T242      " + $DEPTH
	STRING $SMUSSO      = "VITI CAMERA M16 SMUSSO        1         T369      3"
	$TOOLPATHS = {$DRILL , $SMUSSO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Viti\M16\VITI CAMERA M16.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M16_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M16_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M16_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M16_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Scarico side
//Toolpath Creation for Spine
FUNCTION SPINE_SCARICO_D10_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $PORTHOLE , BOOL $FLAT , BOOL $TWOPARTS , BOOL $THREEPARTS , BOOL $ALLARGATORE_FIRST , BOOL $PIANA_FIRST  , BOOL $MATRICE , BOOL $PIANA , BOOL $COLLARINO_CAMERA , BOOL $COLLARINO_SCARICO  , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT , STRING $WP_SCARICO , BOOL $SPINE_DIFFER) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT - 10
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $FLAT AND $TWOPARTS AND $ALLARGATORE_FIRST AND NOT $COLLARINO_CAMERA {
		//Pack 4 has nothing to drill in scarico
		BREAK
	} ELSEIF $PIANA_FIRST AND $SPINE_ALLIGN {
		//FINtf Procedure              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $CENTRINO    = "SPINE SCARICO D10 CENTRINO    2         T202      3"
		STRING $DRILL       = "SPINE SCARICO D10 DRILL       2         T225      " + $DEPTH
		STRING $PREFIN      = "SPINE SCARICO D10 PREFIN      2         T964      10"
		STRING $SMUSSO      = "SPINE SCARICO D10 SMUSSO      1         T806      3"
		STRING $SEMIFIN     = "SPINE SCARICO D10 SEMIFIN     2         T971      9"
		STRING $FIN         = "SPINE SCARICO D10 FIN         2         T803      9"
		$TOOLPATHS = {$CENTRINO , $DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spine\D10\SPINE SCARICO D10 FINTF.ptf"
	} ELSEIF $SPINE_DIFFER {
		//FINsf Procedure              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $CENTRINO    = "SPINE SCARICO D10 CENTRINO    2         T202      3"
		STRING $DRILL       = "SPINE SCARICO D10 DRILL       2         T225      " + $DEPTH
		STRING $PREFIN      = "SPINE SCARICO D10 PREFIN      2         T964      10"
		STRING $SMUSSO      = "SPINE SCARICO D10 SMUSSO      1         T806      3"
		STRING $SEMIFIN     = "SPINE SCARICO D10 SEMIFIN     2         T971      9"
		STRING $FIN         = "SPINE SCARICO D10 FIN         2         T803      9"
		$TOOLPATHS = {$CENTRINO , $DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spine\D10\SPINE SCARICO D10 FINSF.ptf"
	} ELSE {
		//SCA Procedure                Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $CENTRINO    = "SPINE SCARICO D10 CENTRINO    2         T202      3"
		STRING $DRILL       = "SPINE SCARICO D10 DRILL       2         T232      15"
		STRING $SMUSSO      = "SPINE SCARICO D10 SMUSSO      1         T369      3"
		$TOOLPATHS = {$CENTRINO , $DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spine\D10\SPINE SCARICO D10 SCA.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 2)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D10_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D10_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D10_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D10_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINE_SCARICO_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $PORTHOLE , BOOL $FLAT , BOOL $TWOPARTS , BOOL $THREEPARTS , BOOL $ALLARGATORE_FIRST , BOOL $PIANA_FIRST  , BOOL $MATRICE , BOOL $PIANA , BOOL $COLLARINO_CAMERA , BOOL $COLLARINO_SCARICO  , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT , STRING $WP_SCARICO , BOOL $SPINE_DIFFER) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT - 10
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $FLAT AND $TWOPARTS AND $ALLARGATORE_FIRST AND NOT $COLLARINO_CAMERA {
		//Pack 4 has nothing to drill in scarico
		BREAK
	} ELSEIF $PIANA_FIRST AND $SPINE_ALLIGN {
		//FINtf Procedure              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D12 DRILL       2         T228      " + $DEPTH
		STRING $PREFIN      = "SPINE SCARICO D12 PREFIN      2         T965      17"
		STRING $SMUSSO      = "SPINE SCARICO D12 SMUSSO      1         T806      3"
		STRING $SEMIFIN     = "SPINE SCARICO D12 SEMIFIN     2         T972      17"
		STRING $FIN         = "SPINE SCARICO D12 FIN         2         T803      17"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spine\D12\SPINE SCARICO D12 FINTF.ptf"
	} ELSEIF NOT $PIANA_FIRST AND $SPINE_DIFFER {
		//FINsf Procedure              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D12 DRILL       2         T228      " + $DEPTH
		STRING $PREFIN      = "SPINE SCARICO D12 PREFIN      2         T965      17"
		STRING $SMUSSO      = "SPINE SCARICO D12 SMUSSO      1         T806      3"
		STRING $SEMIFIN     = "SPINE SCARICO D12 SEMIFIN     2         T972      17"
		STRING $FIN         = "SPINE SCARICO D12 FIN         2         T803      17"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spine\D12\SPINE SCARICO D12 FINSF.ptf"
	} ELSEIF $PIANA_FIRST {
		//SCA Procedure FLAT           Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D12 DRILL       2         T238      20"
		STRING $SMUSSO      = "SPINE SCARICO D12 SMUSSO      1         T369      3"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spine\D12\SPINE SCARICO D12 SCA.ptf"
	} ELSE {
		//SCA Procedure PORTHOLE       Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D12 DRILL       2         T238      " + $DEPTH
		STRING $SMUSSO      = "SPINE SCARICO D12 SMUSSO      1         T369      3"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spine\D12\SPINE SCARICO D12 SCA.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 2)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINE_SCARICO_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $PORTHOLE , BOOL $FLAT , BOOL $TWOPARTS , BOOL $THREEPARTS , BOOL $ALLARGATORE_FIRST , BOOL $PIANA_FIRST  , BOOL $MATRICE , BOOL $PIANA , BOOL $COLLARINO_CAMERA , BOOL $COLLARINO_SCARICO  , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT , STRING $WP_SCARICO , BOOL $SPINE_DIFFER) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT - 10
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $FLAT AND $TWOPARTS AND $ALLARGATORE_FIRST AND NOT $COLLARINO_CAMERA {
		//Pack 4 has nothing to drill in scarico
		BREAK
	} ELSEIF $PIANA_FIRST AND $SPINE_ALLIGN {
		//FINtf Procedure              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D16 DRILL       2         T238      " + $DEPTH
		STRING $PREFIN      = "SPINE SCARICO D16 PREFIN      2         T967      17"
		STRING $SMUSSO      = "SPINE SCARICO D16 SMUSSO      1         T806      3"
		STRING $SEMIFIN     = "SPINE SCARICO D16 SEMIFIN     2         T973      17"
		STRING $FIN         = "SPINE SCARICO D16 FIN         2         T973      17"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spine\D16\SPINE SCARICO D16 FINTF.ptf"
	} ELSEIF $SPINE_DIFFER {
		//FINsf Procedure              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D16 DRILL       2         T238      " + $DEPTH
		STRING $PREFIN      = "SPINE SCARICO D16 PREFIN      2         T967      17"
		STRING $SMUSSO      = "SPINE SCARICO D16 SMUSSO      1         T806      3"
		STRING $SEMIFIN     = "SPINE SCARICO D16 SEMIFIN     2         T973      17"
		STRING $FIN         = "SPINE SCARICO D16 FIN         2         T973      17"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spine\D16\SPINE SCARICO D16 FINSF.ptf"
	} ELSE {
		//SCA Procedure                Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D16 DRILL       2         T260      25"
		STRING $SMUSSO      = "SPINE SCARICO D16 SMUSSO      1         T369      3"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spine\D16\SPINE SCARICO D16 SCA.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Toolpath Creation for Viti
FUNCTION VITI_SCARICO_D10_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $PORTHOLE , BOOL $FLAT , BOOL $TWOPARTS , BOOL $THREEPARTS , BOOL $ALLARGATORE_FIRST , BOOL $PIANA_FIRST  , BOOL $MATRICE , BOOL $PIANA , BOOL $COLLARINO_CAMERA , BOOL $COLLARINO_SCARICO  , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT / 2 + 7
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF ($PORTHOLE AND $TWOPARTS) OR ($FLAT AND $TWOPARTS AND $ALLARGATORE_FIRST) {
		//With Head                    Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $CENTRINO    = "VITI SCARICO M10 CENTRINO     3         T202      3"
		STRING $DRILL       = "VITI SCARICO M10 DRILL        3         T232      " + $DEPTH
		STRING $HEAD        = "VITI SCARICO M10 HEAD         2         T330      15"
		STRING $SMUSSO      = "VITI SCARICO M10 SMUSSO       1         T369      3"
		$TOOLPATHS = {$CENTRINO , $DRILL , $HEAD , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Viti\M10\VITI SCARICO WITH HEAD M10.ptf"
	} ELSEIF $PIANA_FIRST {
		//With Maschio              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $CENTRINO    = "VITI SCARICO M10 CENTRINO     3         T202      3"
		STRING $DRILL       = "VITI SCARICO M10 DRILL        2         T225      25"
		STRING $SMUSSO      = "VITI SCARICO M10 SMUSSO       1         T369      3"
		STRING $MASCHIO     = "VITI SCARICO M10 MASCHIO      1         T701      20"
		$TOOLPATHS = {$CENTRINO , $DRILL , $SMUSSO , $MASCHIO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Viti\M10\VITI SCARICO WITH MASCHIO M10.ptf"
	} ELSE {
		//Simple Hole                  Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $CENTRINO    = "VITI SCARICO M10 CENTRINO     3         T202      3"
		STRING $DRILL       = "VITI SCARICO M10 DRILL        2         T232      " + $DEPTH
		STRING $SMUSSO      = "VITI SCARICO M10 SMUSSO       1         T369      3"
		$TOOLPATHS = {$CENTRINO , $DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Viti\M10\VITI SCARICO M10.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_SCARICO_M10_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_SCARICO_M10_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_SCARICO_M10_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_SCARICO_M10_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION VITI_SCARICO_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $PORTHOLE , BOOL $FLAT , BOOL $TWOPARTS , BOOL $THREEPARTS , BOOL $ALLARGATORE_FIRST , BOOL $PIANA_FIRST  , BOOL $MATRICE , BOOL $PIANA , BOOL $COLLARINO_CAMERA , BOOL $COLLARINO_SCARICO  , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT / 2 + 7
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF ($PORTHOLE AND $TWOPARTS) OR ($FLAT AND $TWOPARTS AND $ALLARGATORE_FIRST) {
		//With Head                    Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "VITI SCARICO M12 DRILL        3         T238      " + $DEPTH
		STRING $HEAD        = "VITI SCARICO M12 HEAD         2         T330      17"
		STRING $SMUSSO      = "VITI SCARICO M12 SMUSSO       1         T369      3"
		$TOOLPATHS = {$DRILL , $HEAD , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Viti\M12\VITI SCARICO WITH HEAD M12.ptf"
	} ELSEIF $PIANA_FIRST {
		//With Maschio                 Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "VITI SCARICO M12 DRILL        2         T228      30"
		STRING $SMUSSO      = "VITI SCARICO M12 SMUSSO       1         T369      3"
		STRING $MASCHIO     = "VITI SCARICO M12 MASCHIO      2         T702      24"
		$TOOLPATHS = {$DRILL , $SMUSSO , $MASCHIO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Viti\M12\VITI SCARICO WITH MASCHIO M12.ptf"
	} ELSE {
		//Simple Hole                  Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "VITI SCARICO M12 DRILL        2         T238      " + $DEPTH
		STRING $SMUSSO      = "VITI SCARICO M12 SMUSSO       1         T369      3"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Viti\M12\VITI SCARICO M12.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_SCARICO_M12_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_SCARICO_M12_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_SCARICO_M12_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_SCARICO_M12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION VITI_SCARICO_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $PORTHOLE , BOOL $FLAT , BOOL $TWOPARTS , BOOL $THREEPARTS , BOOL $ALLARGATORE_FIRST , BOOL $PIANA_FIRST  , BOOL $MATRICE , BOOL $PIANA , BOOL $COLLARINO_CAMERA , BOOL $COLLARINO_SCARICO  , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT / 2 + 7
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF ($PORTHOLE AND $TWOPARTS) OR ($FLAT AND $TWOPARTS AND $ALLARGATORE_FIRST) {
		//With Head                    Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "VITI SCARICO M16 DRILL        3         T260      " + $DEPTH
		STRING $HEAD        = "VITI SCARICO M16 HEAD         2         T421      21"
		STRING $SMUSSO      = "VITI SCARICO M16 SMUSSO       1         T369      3"
		$TOOLPATHS = {$DRILL , $HEAD , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Viti\M16\VITI SCARICO WITH HEAD M16.ptf"
	} ELSEIF $PIANA_FIRST {
		//With Maschio                 Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "VITI SCARICO M16 DRILL        2         T238      40"
		STRING $SMUSSO      = "VITI SCARICO M16 SMUSSO       1         T369      3"
		STRING $MASCHIO     = "VITI SCARICO M16 MASCHIO      1         T704      32"
		$TOOLPATHS = {$DRILL , $SMUSSO , $MASCHIO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Viti\M16\VITI SCARICO M16.ptf"
	} ELSE {
		//Simple Hole                  Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "VITI SCARICO M16 DRILL        2         T260      " + $DEPTH
		STRING $SMUSSO      = "VITI SCARICO M16 SMUSSO       1         T369      3"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Viti\M16\VITI SCARICO M16.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_SCARICO_M16_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_SCARICO_M16_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_SCARICO_M16_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_SCARICO_M16_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Toolpath Creation for Spinone
FUNCTION SPINONE_SCARICO_D6_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index  Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $CENTRINO    = "SPINONE SCARICO D6 CENTRINO   2         T202      3"
	STRING $PREDRILL    = "SPINONE SCARICO D6 PREDRILL   2         T215      18"
	STRING $DRILL       = "SPINONE SCARICO D6 DRILL      2         T219      18"
	STRING $SMUSSO      = "SPINONE SCARICO D6 SMUSSO     2         T369      3.4"
	$TOOLPATHS = {$CENTRINO , $PREDRILL , $DRILL , $SMUSSO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spinone\D6\SPINONE SCARICO D6 FINSF.ptf"
	
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D6_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D6_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D6_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D6_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_SCARICO_D8_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index  Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $CENTRINO    = "SPINONE SCARICO D8 CENTRINO   2         T202      3"
	STRING $DRILL       = "SPINONE SCARICO D8 DRILL      2         T219      15"
	STRING $PREFIN      = "SPINONE SCARICO D8 PREFIN     2         T977      10"
	STRING $SMUSSO      = "SPINONE SCARICO D8 SMUSSO     1         T806      3"
	STRING $SEMIFIN     = "SPINONE SCARICO D8 SEMIFIN    2         T957      9"
	STRING $FIN         = "SPINONE SCARICO D8 FIN        2         T957      9"
	$TOOLPATHS = {$CENTRINO , $DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spinone\D8\SPINONE SCARICO D8 FINSF.ptf"
	
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D8_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D8_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D8_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D8_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_SCARICO_D10_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index  Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $CENTRINO    = "SPINONE SCARICO D10 CENTRINO  2         T202      3"
	STRING $DRILL       = "SPINONE SCARICO D10 DRILL     2         T225      15"
	STRING $PREFIN      = "SPINONE SCARICO D10 PREFIN    2         T964      10"
	STRING $SMUSSO      = "SPINONE SCARICO D10 SMUSSO    1         T806      3"
	STRING $SEMIFIN     = "SPINONE SCARICO D10 SEMIFIN   2         T971      9"
	STRING $FIN         = "SPINONE SCARICO D10 FIN       2         T971      9"
	$TOOLPATHS = {$CENTRINO , $DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spinone\D10\SPINONE SCARICO D10 FINSF.ptf"
	
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D10_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D10_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D10_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D10_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_SCARICO_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index  Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE SCARICO D12 DRILL     2         T228      20"
	STRING $PREFIN      = "SPINONE SCARICO D12 PREFIN    2         T965      17"
	STRING $SMUSSO      = "SPINONE SCARICO D12 SMUSSO    1         T806      3"
	STRING $SEMIFIN     = "SPINONE SCARICO D12 SEMIFIN   2         T972      17"
	STRING $FIN         = "SPINONE SCARICO D12 FIN       2         T972      17"
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spinone\D12\SPINONE SCARICO D12 FINSF.ptf"
	
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_SCARICO_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE SCARICO D16 DRILL     2         T238      25"
	STRING $PREFIN      = "SPINONE SCARICO D16 PREFIN    2         T966      17"
	STRING $SMUSSO      = "SPINONE SCARICO D16 SMUSSO    1         T806      3"
	STRING $SEMIFIN     = "SPINONE SCARICO D16 SEMIFIN   2         T983      17"
	STRING $FIN         = "SPINONE SCARICO D16 FIN       2         T983      17"
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
		
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spinone\D16\SPINONE SCARICO D16 FINSF.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D16_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D16_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D16_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D16_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_SCARICO_D20_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE SCARICO D20 DRILL     2         T260      30"
	STRING $PREFIN      = "SPINONE SCARICO D20 PREFIN    2         T967      23"
	STRING $SMUSSO      = "SPINONE SCARICO D20 SMUSSO    1         T806      3"
	STRING $SEMIFIN     = "SPINONE SCARICO D20 SEMIFIN   2         T983      17"
	STRING $FIN         = "SPINONE SCARICO D20 FIN       2         T983      17"
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
		
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spinone\D20\SPINONE SCARICO D20 FINSF.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D20_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D20_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D20_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D20_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_SCARICO_D24_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = 25
	
	STRING $AUTOORNOT = "Spinone D24 defined depth is " + $DEPTH + CRLF + "Do you want to change the depth?"
	BOOL $AUTOAGREE = FALSE
	$AUTOAGREE = QUERY $AUTOORNOT
	IF $AUTOAGREE {
		$DEPTH = INPUT "Spinone D24 Depth:"
		WHILE $DEPTH < 0 {
			MESSAGE INFO "The value must be positive"
			$DEPTH = INPUT "Spinone D24 Depth:"
		}
	}
	
	REAL $HELICALDEPTH = $DEPTH
	REAL $PREFINDEPTH = $DEPTH - 2
	REAL $SEMIFINDEPTH = $DEPTH - 4
	REAL $FINDEPTH = $DEPTH - 4
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE SCARICO D24 HELICAL   2         T421      " + $HELICALDEPTH
	STRING $PREFIN      = "SPINONE SCARICO D24 PREFIN    2         T967      " + $PREFINDEPTH
	STRING $SMUSSO      = "SPINONE SCARICO D24 SMUSSO    1         T806      3"
	STRING $SEMIFIN     = "SPINONE SCARICO D24 SEMIFIN   2         T974      " + $SEMIFINDEPTH
	STRING $FIN         = "SPINONE SCARICO D24 FIN       2         T974      " + $FINDEPTH
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
		
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spinone\D24\SPINONE SCARICO D24 FINSF.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D24_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D24_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D24_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D24_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINONE_SCARICO_D30_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH = 30
	
	STRING $AUTOORNOT = "Spinone D30 defined depth is " + $DEPTH + CRLF + "Do you want to change the depth?"
	BOOL $AUTOAGREE = FALSE
	$AUTOAGREE = QUERY $AUTOORNOT
	IF $AUTOAGREE {
		$DEPTH = INPUT "Spinone D30 Depth:"
		WHILE $DEPTH < 0 {
			MESSAGE INFO "The value must be positive"
			$DEPTH = INPUT "Spinone D30 Depth:"
		}
	}
	
	REAL $HELICALDEPTH = $DEPTH
	REAL $PREFINDEPTH = $DEPTH - 2
	REAL $SEMIFINDEPTH = $DEPTH - 4
	REAL $FINDEPTH = $DEPTH - 4
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SPINONE SCARICO D30 HELICAL   2         T421      " + $HELICALDEPTH
	STRING $PREFIN      = "SPINONE SCARICO D30 PREFIN    2         T967      " + $PREFINDEPTH
	STRING $SMUSSO      = "SPINONE SCARICO D30 SMUSSO    1         T806      3"
	STRING $SEMIFIN     = "SPINONE SCARICO D30 SEMIFIN   2         T967      " + $SEMIFINDEPTH
	STRING $FIN         = "SPINONE SCARICO D30 FIN       2         T967      " + $FINDEPTH
	$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
		
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spinone\D30\SPINONE SCARICO D30 FINSF.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D30_1"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D30_2"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D30_3"
		EDIT FEATURESET $SETNAME SELECT "SPINONE_SCARICO_D30_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Toolpath Creation for Viti
FUNCTION SOLLEVATORE_SCARICO_D10_TEMPLATE(STRING $SETNAME , STRING $COMPANY , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//Non counterbore                  Toolpath                  Index       Tool    Depth
	//                              10        20        30        40        50        60
	//                     0123456789012345678901234567890123456789012345678901234567890
	STRING $CENTRINO    = "SOLLEVATORE SCARICO M10 CENTRINO        3         T202      3"
	STRING $DRILL       = "SOLLEVATORE SCARICO M10 DRILL           2         T232      20"
	STRING $SMUSSO      = "SOLLEVATORE SCARICO M10 SMUSSO          1         T369      3"
	STRING $MASCHIO     = "SOLLEVATORE SCARICO M10 MASCHIO         1         T701      15"
	$TOOLPATHS = {$CENTRINO , $DRILL , $SMUSSO , $MASCHIO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 39))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Sollevatore\M10\SOLLEVATORE SCARICO M10.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 39))
		INT $INDEX = SUBSTRING($PACKET , 40 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 50 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 60 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SOLLEVATORE_SCARICO_M10_1"
		EDIT FEATURESET $SETNAME SELECT "SOLLEVATORE_SCARICO_M10_2"
		EDIT FEATURESET $SETNAME SELECT "SOLLEVATORE_SCARICO_M10_3"
		EDIT FEATURESET $SETNAME SELECT "SOLLEVATORE_SCARICO_M10_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SOLLEVATORE_SCARICO_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//Non counterbore                  Toolpath                  Index       Tool    Depth
	//                              10        20        30        40        50        60
	//                     0123456789012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SOLLEVATORE SCARICO M12 DRILL           2         T228      24"
	STRING $SMUSSO      = "SOLLEVATORE SCARICO M12 SMUSSO          1         T369      3"
	STRING $MASCHIO     = "SOLLEVATORE SCARICO M12 MASCHIO         1         T702      18"
	$TOOLPATHS = {$DRILL , $SMUSSO , $MASCHIO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 39))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Sollevatore\M12\SOLLEVATORE SCARICO M12.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 39))
		INT $INDEX = SUBSTRING($PACKET , 40 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 50 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 60 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SOLLEVATORE_SCARICO_M12_1"
		EDIT FEATURESET $SETNAME SELECT "SOLLEVATORE_SCARICO_M12_2"
		EDIT FEATURESET $SETNAME SELECT "SOLLEVATORE_SCARICO_M12_3"
		EDIT FEATURESET $SETNAME SELECT "SOLLEVATORE_SCARICO_M12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SOLLEVATORE_SCARICO_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//Non counterbore                  Toolpath                  Index       Tool    Depth
	//                              10        20        30        40        50        60
	//                     0123456789012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "SOLLEVATORE SCARICO M16 DRILL           2         T238      32"
	STRING $SMUSSO      = "SOLLEVATORE SCARICO M16 SMUSSO          1         T369      3"
	STRING $MASCHIO     = "SOLLEVATORE SCARICO M16 MASCHIO         1         T704      24"
	$TOOLPATHS = {$DRILL , $SMUSSO , $MASCHIO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 39))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Sollevatore\M16\SOLLEVATORE SCARICO M16.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 39))
		INT $INDEX = SUBSTRING($PACKET , 40 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 50 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 60 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SOLLEVATORE_SCARICO_M16_1"
		EDIT FEATURESET $SETNAME SELECT "SOLLEVATORE_SCARICO_M16_2"
		EDIT FEATURESET $SETNAME SELECT "SOLLEVATORE_SCARICO_M16_3"
		EDIT FEATURESET $SETNAME SELECT "SOLLEVATORE_SCARICO_M16_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Terzapiastra and Sottomatrice
//Impronta side
//Toolpath Creation for Spine
FUNCTION SPINE_IMPRONTA_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $TERZAPIASTRA , BOOL $SOTTOMATRICE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		//SGR Procedure                Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE IMPRONTA D12 DRILL       2         T228"
		STRING $SMUSSO      = "SPINE IMPRONTA D12 SMUSSO      1         T806"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Impronta\Spine\D12\SPINE IMPRONTA D12 SGR.ptf"
	} ELSE {
		
		//FINtf Procedure              Toolpath            Index  Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE IMPRONTA D12 DRILL       2         T238"
		STRING $PREFIN      = "SPINE IMPRONTA D12 PREFIN      2         T966"
		STRING $SMUSSO      = "SPINE IMPRONTA D12 SMUSSO      1         T806"
		STRING $SEMIFIN     = "SPINE IMPRONTA D12 SEMIFIN     2         T973"
		STRING $FIN         = "SPINE IMPRONTA D12 FIN         2         T973"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Impronta\Spine\D12\SPINE IMPRONTA D12 FINTF.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_IMPRONTA_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_IMPRONTA_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_IMPRONTA_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_IMPRONTA_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINE_IMPRONTA_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $TERZAPIASTRA , BOOL $SOTTOMATRICE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN) {
//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		//SGR Procedure                Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE IMPRONTA D16 DRILL       2         T240"
		STRING $SMUSSO      = "SPINE IMPRONTA D16 SMUSSO      1         T369"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Impronta\Spine\D16\SPINE IMPRONTA D16 SGR.ptf"
	} ELSE {
		
		//FINtf Procedure              Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE IMPRONTA D16 DRILL       2         T238"
		STRING $PREFIN      = "SPINE IMPRONTA D16 PREFIN      2         T966"
		STRING $SMUSSO      = "SPINE IMPRONTA D16 SMUSSO      1         T806"
		STRING $SEMIFIN     = "SPINE IMPRONTA D16 SEMIFIN     2         T983"
		STRING $FIN         = "SPINE IMPRONTA D16 FIN         2         T983"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Impronta\Spine\D16\SPINE IMPRONTA D16 FINTF.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_IMPRONTA_D16_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_IMPRONTA_D16_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_IMPRONTA_D16_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_IMPRONTA_D16_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Toolpath Creation for Viti
FUNCTION VITI_IMPRONTA_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $TERZAPIASTRA , BOOL $SOTTOMATRICE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "VITI IMPRONTA M12 DRILL        2         T228"
	STRING $SMUSSO      = "VITI IMPRONTA M12 SMUSSO       1         T369"
	STRING $MASCHIO     = "VITI IMPRONTA M12 MASCHIO      2         T702"
	$TOOLPATHS = {$DRILL , $SMUSSO , $MASCHIO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Impronta\Viti\M12\VITI IMPRONTA M12.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_IMPRONTA_M12_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_IMPRONTA_M12_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_IMPRONTA_M12_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_IMPRONTA_M12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION VITI_IMPRONTA_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $TERZAPIASTRA , BOOL $SOTTOMATRICE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "VITI IMPRONTA M16 DRILL        2         T238"
	STRING $SMUSSO      = "VITI IMPRONTA M16 SMUSSO       1         T369"
	STRING $MASCHIO     = "VITI IMPRONTA M16 MASCHIO      2         T704"
	$TOOLPATHS = {$DRILL , $SMUSSO , $MASCHIO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Impronta\Viti\M16\VITI IMPRONTA M16.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_IMPRONTA_M16_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_IMPRONTA_M16_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_IMPRONTA_M16_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_IMPRONTA_M16_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Uscita side
//Toolpath Creation for Spine
FUNCTION SPINE_USCITA_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $TERZAPIASTRA , BOOL $SOTTOMATRICE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_USCITA) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT - 10
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $FLAT AND $TWOPARTS AND $ALLARGATORE_FIRST AND NOT $COLLARINO_CAMERA {
		//Pack 4 has nothing to drill in scarico
		BREAK
	} ELSEIF $PIANA_FIRST AND $SPINE_ALLIGN {
		//FINtf Procedure              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE USCITA D12 DRILL       2         T228      " + $DEPTH
		STRING $PREFIN      = "SPINE USCITA D12 PREFIN      2         T965      17"
		STRING $SMUSSO      = "SPINE USCITA D12 SMUSSO      1         T806      3"
		STRING $SEMIFIN     = "SPINE USCITA D12 SEMIFIN     2         T972      17"
		STRING $FIN         = "SPINE USCITA D12 FIN         2         T803      17"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Uscita\Spine\D12\SPINE USCITA D12 FINTF.ptf"
	} ELSEIF $SPINE_DIFFER {
		//FINsf Procedure              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D12 DRILL       2         T228      " + $DEPTH
		STRING $PREFIN      = "SPINE SCARICO D12 PREFIN      2         T965      17"
		STRING $SMUSSO      = "SPINE SCARICO D12 SMUSSO      1         T806      3"
		STRING $SEMIFIN     = "SPINE SCARICO D12 SEMIFIN     2         T972      17"
		STRING $FIN         = "SPINE SCARICO D12 FIN         2         T803      17"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Uscita\Spine\D12\SPINE USCITA D12 FINSF.ptf"
	} ELSE {
		//SCA Procedure                Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE USCITA D12 DRILL       2         T238      " + $DEPTH
		STRING $SMUSSO      = "SPINE USCITA D12 SMUSSO      1         T806      3"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spine\D12\SPINE SCARICO D12 SCA.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 2)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINE_USCITA_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $TERZAPIASTRA , BOOL $SOTTOMATRICE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_USCITA) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT - 10
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $FLAT AND $TWOPARTS AND $ALLARGATORE_FIRST AND NOT $COLLARINO_CAMERA {
		//Pack 4 has nothing to drill in scarico
		BREAK
	} ELSEIF $PIANA_FIRST AND $SPINE_ALLIGN {
		//FINtf Procedure              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D16 DRILL       2         T238      " + $DEPTH
		STRING $PREFIN      = "SPINE SCARICO D16 PREFIN      2         T967      17"
		STRING $SMUSSO      = "SPINE SCARICO D16 SMUSSO      1         T806      3"
		STRING $SEMIFIN     = "SPINE SCARICO D16 SEMIFIN     2         T973      17"
		STRING $FIN         = "SPINE SCARICO D16 FIN         2         T973      17"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spine\D16\SPINE SCARICO D16 FINTF.ptf"
	} ELSEIF $SPINE_DIFFER {
		//FINsf Procedure              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D16 DRILL       2         T238      " + $DEPTH
		STRING $PREFIN      = "SPINE SCARICO D16 PREFIN      2         T967      17"
		STRING $SMUSSO      = "SPINE SCARICO D16 SMUSSO      1         T806      3"
		STRING $SEMIFIN     = "SPINE SCARICO D16 SEMIFIN     2         T973      17"
		STRING $FIN         = "SPINE SCARICO D16 FIN         2         T973      17"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spine\D16\SPINE SCARICO D16 FINSF.ptf"
	} ELSE {
		//SCA Procedure                Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D16 DRILL       2         T228      " + $DEPTH
		STRING $SMUSSO      = "SPINE SCARICO D16 SMUSSO      1         T806      3"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Scarico\Spine\D16\SPINE SCARICO D16 SCA.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Uscita Creation for Viti
FUNCTION VITI_USCITA_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $TERZAPIASTRA , BOOL $SOTTOMATRICE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_USCITA) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT / 2 + 7
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF ($PORTHOLE AND $TWOPARTS) OR ($FLAT AND $TWOPARTS AND $ALLARGATORE_FIRST) {
		//Non counterbore              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "VITI USCITA M12 DRILL        3         T238      " + $DEPTH
		STRING $HEAD        = "VITI USCITA M12 HEAD         2         T330      17"
		STRING $SMUSSO      = "VITI USCITA M12 SMUSSO       1         T369      3"
		$TOOLPATHS = {$DRILL , $HEAD , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Uscita\Viti\M12\VITI USCITA WITH HEAD M12.ptf"
	} ELSE {
		//Non counterbore              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "VITI USCITA M12 DRILL        2         T238      " + $DEPTH
		STRING $SMUSSO      = "VITI USCITA M12 SMUSSO       1         T369      3"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Uscita\Viti\M12\VITI USCITA M12.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_USCITA
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_USCITA_M12_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_USCITA_M12_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_USCITA_M12_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_USCITA_M12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION VITI_USCITA_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $TERZAPIASTRA , BOOL $SOTTOMATRICE , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_USCITA) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT / 2 + 7
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF ($PORTHOLE AND $TWOPARTS) OR ($FLAT AND $TWOPARTS AND $ALLARGATORE_FIRST) {
		//Non counterbore              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "VITI USCITA M16 DRILL        3         T260      " + $DEPTH
		STRING $HEAD        = "VITI USCITA M16 HEAD         2         T421      21"
		STRING $SMUSSO      = "VITI USCITA M16 SMUSSO       1         T369      3"
		$TOOLPATHS = {$DRILL , $HEAD , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Viti\M12\VITI CAMERA WITH HEAD M12.ptf"
	} ELSE {
		//Non counterbore              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "VITI USCITA M16 DRILL        2         T260      " + $DEPTH
		STRING $SMUSSO      = "VITI USCITA M16 SMUSSO       1         T369      3"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\3D\GitHub\Alumat\Powermill\Tamplates\Camera\Viti\M12\VITI CAMERA M12.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_USCITA
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M16_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M16_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M16_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M16_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}
