FUNCTION CENTRINO_MANDREL(STRING $COMPANY , REAL $DIAMETER) {
	//Import Centrino Feature Set
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\ENTRATA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Matrex\Powermill\Imports\CENTERING HOLES\CENTERING_HOLES.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES"
	DEACTIVATE FOLDER
	
	//Define Movements on XYZ
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_RIGHT"

	//Toolpath Variables
	//CENTERING_HOLES           Toolpath                Index       Tool    Depth
	//                              10        20        30        40        50
	//                      012345678901234567890123456789012345678901234567890
	STRING $PACKET       = "CENTERING HOLES               1         T203      8"
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
	INT $INDEX = SUBSTRING($PACKET , 30 , 1)
	STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
	REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW	
	
	//Import Toolpath
	IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
		DELETE Toolpath $PATHNAME NOQUIBBLE
	}
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Entrata\Centrino\Centrino.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Drill Toolpath
	ACTIVATE Toolpath $PATHNAME
	//Depth
	EDIT DRILL DEPTH $DRILLDEPTH
	//Tool
	IF $COMPANY == "Matrex" {
		CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	} ELSEIF $COMPANY == "Alumat" {
		CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	} ELSE {
		MESSAGE ERROR "Uknown Company"
	}
	ACTIVATE TOOL $NAME
	EDIT RPM $SPEED
	EDIT FRATE $FEED
	EDIT PRATE $PLUNGE
	//Rapids
	EDIT TOOLPATH SAFEAREA SIZE "2"
	EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
	//Component Thickness
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	EDIT TOOLPATH ; THICKNESS ACQUIRE
	EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
	//Select Featureset Components
	ACTIVATE Featureset "CENTERING_HOLES"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	//Calculate
	EDIT TOOLPATH $PATHNAME CALCULATE
	BLANK UNDO
	DEACTIVATE Toolpath
	DEACTIVATE Tool
	DEACTIVATE Featureset
}

FUNCTION CENTRINO_ALLARGATORE(STRING $COMPANY , REAL $DIAMETER , REAL $HEIGHT , INT $PIECECODE , STRING $WP_POZZETO) {
	//Import Centrino Feature Set
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\POZZETO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Matrex\Powermill\Imports\CENTERING HOLES\CENTERING_HOLES.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_POZZETO
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_RIGHT"
	
	//Define Movements on XYZ
	REAL $GAP = 0
	IF $PIECECODE == 7 {
		$GAP = -6
	} ELSEIF $PIECECODE == 6 {
		$GAP = 10
	} ELSE {
		$GAP = 7
	}
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_RIGHT"

	//Toolpaths Variables
	//CENTERING_HOLES           Toolpath                Index       Tool    Depth
	//                              10        20        30        40        50
	//                      012345678901234567890123456789012345678901234567890
	STRING $PACKET       = "CENTERING HOLES               1         T203      8"
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
	INT $INDEX = SUBSTRING($PACKET , 30 , 1)
	STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
	REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW	
	
	//Import Toolpath
	IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
		DELETE Toolpath $PATHNAME NOQUIBBLE
	}
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Pozzeto\Centrino\Centrino.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Drill Toolpath
	ACTIVATE Toolpath $PATHNAME
	//Workplane
	ACTIVATE WORKPLANE $WP_POZZETO
	//Depth
	EDIT DRILL DEPTH $DRILLDEPTH
	//Tool
	IF $COMPANY == "Matrex" {
		CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	} ELSEIF $COMPANY == "Alumat" {
		CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	} ELSE {
		MESSAGE ERROR "Uknown Company"
	}
	ACTIVATE TOOL $NAME
	EDIT RPM $SPEED
	EDIT FRATE $FEED
	EDIT PRATE $PLUNGE
	//Rapids
	REAL $RAPIDHEIGHT = $HEIGHT + 2
	EDIT TOOLPATH SAFEAREA SIZE $RAPIDHEIGHT
	EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  $RAPIDHEIGHT
	//Component Thickness
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	EDIT TOOLPATH ; THICKNESS ACQUIRE
	EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
	//Select Featureset Components
	ACTIVATE Featureset "CENTERING_HOLES"
	//EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	//EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	//Calculate
	EDIT TOOLPATH $PATHNAME CALCULATE
	BLANK UNDO
	DEACTIVATE Toolpath
	DEACTIVATE Tool
	DEACTIVATE Featureset
}

FUNCTION CENTRINO_MATRICE(STRING $COMPANY , BOOL $TWOPARTS , BOOL $THREEPARTS , REAL $DIAMETER , REAL $HEIGHT , INT $PIECECODE , STRING $WP_SCARICO) {
	//Import Centrino Feature Set
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\SCARICO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Matrex\Powermill\Imports\CENTERING HOLES\CENTERING_HOLES.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_SCARICO
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_RIGHT"
	
	//Define Movements on XYZ
	REAL $GAP = 0
	IF $TWOPARTS {
		$GAP = 20
	} ELSEIF $PIECECODE == 24 OR $PIECECODE == 26 OR $PIECECODE == 28 {
		$GAP = -6
	} ELSEIF $PIECECODE == 22 OR $PIECECODE == 23 OR $PIECECODE == 27 {
		$GAP = 10
	} ELSE {
		$GAP = 10
	}
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_RIGHT"

	//Toolpaths Variables
	//CENTERING_HOLES           Toolpath                Index       Tool    Depth
	//                              10        20        30        40        50
	//                      012345678901234567890123456789012345678901234567890
	STRING $PACKET       = "CENTERING HOLES               1         T203      8"
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
	INT $INDEX = SUBSTRING($PACKET , 30 , 1)
	STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
	REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW	
	
	//Import Toolpath
	IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
		DELETE Toolpath $PATHNAME NOQUIBBLE
	}
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Scarico\Centrino\Centrino.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Drill Toolpath
	ACTIVATE Toolpath $PATHNAME
	//Workplane
	ACTIVATE WORKPLANE $WP_SCARICO
	//Depth
	EDIT DRILL DEPTH $DRILLDEPTH
	//Tool
	IF $COMPANY == "Matrex" {
		CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	} ELSEIF $COMPANY == "Alumat" {
		CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	} ELSE {
		MESSAGE ERROR "Uknown Company"
	}
	ACTIVATE TOOL $NAME
	EDIT RPM $SPEED
	EDIT FRATE $FEED
	EDIT PRATE $PLUNGE
	//Rapids
	REAL $RAPIDHEIGHT = $HEIGHT + 2
	EDIT TOOLPATH SAFEAREA SIZE $RAPIDHEIGHT
	EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  $RAPIDHEIGHT
	//Component Thickness
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	EDIT TOOLPATH ; THICKNESS ACQUIRE
	EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
	//Select Featureset Components
	ACTIVATE Featureset "CENTERING_HOLES"
	//EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	//EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	//Calculate
	EDIT TOOLPATH $PATHNAME CALCULATE
	BLANK UNDO
	DEACTIVATE Toolpath
	DEACTIVATE Tool
	DEACTIVATE Featureset	
}

FUNCTION CENTRINO_PIANA(STRING $COMPANY , BOOL $TWOPARTS , BOOL $THREEPARTS , BOOL $ALLARGATORE_FIRST , BOOL $PIANA_FIRST , REAL $DIAMETER , REAL $HEIGHT , INT $PIECECODE , STRING $WP_SCARICO) {
	//Import Centrino Feature Set
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\SCARICO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Matrex\Powermill\Imports\CENTERING HOLES\CENTERING_HOLES.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_SCARICO
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_RIGHT"
	
	//Define Movements on XYZ
	REAL $GAP = 0
	IF $TWOPARTS AND $ALLARGATORE_FIRST {
		$GAP = 20
	} ELSEIF $PIECECODE == 7 OR $PIECECODE == 24 OR $PIECECODE == 26 OR $PIECECODE == 28 {
		$GAP = -6
	} ELSEIF $PIECECODE == 6 OR $PIECECODE == 22 OR $PIECECODE == 23 OR $PIECECODE == 27 {
		$GAP = 10
	} ELSE {
		$GAP = 10
	}
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_RIGHT"

	//Toolpaths Variables
	//CENTERING_HOLES           Toolpath                Index       Tool    Depth
	//                              10        20        30        40        50
	//                      012345678901234567890123456789012345678901234567890
	STRING $PACKET       = "CENTERING HOLES               1         T203      8"
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
	INT $INDEX = SUBSTRING($PACKET , 30 , 1)
	STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
	REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW	
	
	//Import Toolpath
	IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
		DELETE Toolpath $PATHNAME NOQUIBBLE
	}
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Scarico\Centrino\Centrino.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Drill Toolpath
	ACTIVATE Toolpath $PATHNAME
	//Workplane
	ACTIVATE WORKPLANE $WP_SCARICO
	//Depth
	EDIT DRILL DEPTH $DRILLDEPTH
	//Tool
	IF $COMPANY == "Matrex" {
		CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	} ELSEIF $COMPANY == "Alumat" {
		CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	} ELSE {
		MESSAGE ERROR "Uknown Company"
	}
	ACTIVATE TOOL $NAME
	EDIT RPM $SPEED
	EDIT FRATE $FEED
	EDIT PRATE $PLUNGE
	//Rapids
	REAL $RAPIDHEIGHT = $HEIGHT + 2
	EDIT TOOLPATH SAFEAREA SIZE $RAPIDHEIGHT
	EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  $RAPIDHEIGHT
	//Component Thickness
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	EDIT TOOLPATH ; THICKNESS ACQUIRE
	EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
	//Select Featureset Components
	ACTIVATE Featureset "CENTERING_HOLES"
	//EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	//EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	//Calculate
	EDIT TOOLPATH $PATHNAME CALCULATE
	BLANK UNDO
	DEACTIVATE Toolpath
	DEACTIVATE Tool
	DEACTIVATE Featureset
}




